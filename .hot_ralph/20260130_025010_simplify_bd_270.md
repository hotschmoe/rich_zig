I'll review the recent code changes for the SVG export feature and simplify where appropriate.Now I have a full view of the SVG export code. Let me analyze the code for simplification opportunities.Looking at the code, I've identified several simplification opportunities:

1. **`writeHtmlStyle` and `writeSvgStyle` have nearly identical patterns** - the `needs_sep` pattern is repeated many times
2. **`writeHtmlEscaped` and `writeXmlEscaped` are almost identical** - XML just adds `'` escaping
3. **The line parsing loop in `exportSvg`** can be simplified
4. **The `has_style` check pattern** is repeated in multiple places

Let me make focused simplifications:Now let me update `exportHtml` to use `writeXmlEscaped` (which is a superset of HTML escaping) and simplify `writeSvgStyle` similarly:Tests pass. Let me also run with optimization to be thorough:Good changes. Now let me commit:Done. Here's a summary of the simplifications made:

**Changes (33 additions, 94 deletions = net -61 lines):**

1. **Consolidated attribute handling with `inline for`** - Both `writeHtmlStyle` and `writeSvgStyle` had 6 nearly identical blocks for bold/dim/italic/underline/strike/overline. Replaced with a single `inline for` loop over attribute-string pairs.

2. **Used `Color.getTriplet()` consistently** - The `writeHtmlStyle` function was manually checking `c.triplet` and `c.number` with separate code paths. Now uses `getTriplet()` which handles both cases (the method already converts palette numbers to RGB).

3. **Merged escape functions** - `writeHtmlEscaped` and `writeXmlEscaped` were nearly identical. XML escaping is a superset of HTML escaping (just adds `'` -> `&apos;`), so we now have a single `writeXmlEscaped` used by both HTML and SVG export.

4. **Removed duplicate function** - The original code had `writeXmlEscaped` defined twice (once near the top and once near the bottom). Now there's only one.

All tests pass, including with ReleaseSafe optimization.